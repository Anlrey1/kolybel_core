# üèóÔ∏è –ö–æ–ª—ã–±–µ–ª—å v2 - –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≥–µ–Ω—Ç–æ–≤

## üéØ –û–±–∑–æ—Ä –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ö–æ–ª—ã–±–µ–ª—å v2 —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∞–≥–µ–Ω—Ç–æ–≤**, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- ‚úÖ **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—é –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–Ω—Ç–∞–π–º–∞** - –∞–≥–µ–Ω—Ç—ã –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–∞–Ω—Ç–∞–π–º–∞–º–∏ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Git/DB
- ‚úÖ **–ü–æ—Ä—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **Agent Specification** (–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞)

```python
# –ü—Ä–∏–º–µ—Ä —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞ –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
{
  "id": "rss-monitor-001",
  "name": "DTF RSS Monitor",
  "owner": "kolybel_user",
  "triggers": [
    {
      "type": "schedule",
      "config": {"cron": "0 9,15,20 * * *"}
    }
  ],
  "steps": [
    {
      "id": "fetch_rss",
      "type": "parse_rss",
      "config": {"url": "https://dtf.ru/rss"}
    },
    {
      "id": "generate_content",
      "type": "generate_content",
      "config": {"model": "mistral"}
    },
    {
      "id": "send_telegram",
      "type": "send_message",
      "config": {"platform": "telegram"}
    }
  ],
  "runtime_preferences": ["n8n", "local", "docker"]
}
```

### 2. **Execution Adapters** (–ü–ª–∞–≥–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

#### LocalRuntimeAdapter

- –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ö–æ–ª—ã–±–µ–ª–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã —à–∞–≥–æ–≤
- –í—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ fallback

#### N8NRuntimeAdapter

- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ n8n workflows
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç n8n API –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ —Å–±–æ—è—Ö n8n

#### DockerRuntimeAdapter

- –£–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Kubernetes –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

### 3. **Runtime Orchestrator** (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π:

- **–í—ã–±–∏—Ä–∞–µ—Ç —Ä–∞–Ω—Ç–∞–π–º** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (failover, load balancing)
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –∑–¥–æ—Ä–æ–≤—å–µ** –≤—Å–µ—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤
- **–í–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

#### –ü–æ–ª–∏—Ç–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

- `PRIMARY_ONLY` - —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–Ω—Ç–∞–π–º
- `FAILOVER` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `LOAD_BALANCE` - –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
- `REDUNDANT` - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 4. **Agent Manager** (–ú–µ–Ω–µ–¥–∂–µ—Ä –∞–≥–µ–Ω—Ç–æ–≤)

–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è:

- –°–æ–∑–¥–∞–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
- –ò–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ —Å—Ç–∞—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

## üîÑ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞] --> B[–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏]
    B --> C[–í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤]
    C --> D[–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ —Ä–∞–Ω—Ç–∞–π–º–∞—Ö]
    D --> E[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞]
    E --> F[–ê–≥–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ]
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å Failover

```mermaid
graph TD
    A[–¢—Ä–∏–≥–≥–µ—Ä –∞–≥–µ–Ω—Ç–∞] --> B{–û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–Ω—Ç–∞–π–º –∑–¥–æ—Ä–æ–≤?}
    B -->|–î–∞| C[–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º]
    B -->|–ù–µ—Ç| D[–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π]
    C --> E{–£—Å–ø–µ—à–Ω–æ?}
    D --> E
    E -->|–î–∞| F[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞]
    E -->|–ù–µ—Ç| G[–ü–æ–ø—ã—Ç–∫–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–Ω—Ç–∞–π–º–µ]
    G --> E
```

## üõ†Ô∏è –¢–∏–ø—ã —à–∞–≥–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤

### –ë–∞–∑–æ–≤—ã–µ —à–∞–≥–∏:

- `HTTP_REQUEST` - HTTP –∑–∞–ø—Ä–æ—Å—ã
- `PARSE_RSS` - –ü–∞—Ä—Å–∏–Ω–≥ RSS –ª–µ–Ω—Ç
- `GENERATE_CONTENT` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ LLM
- `SEND_MESSAGE` - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (Telegram, etc.)
- `TRANSFORM_DATA` - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `FILTER_DATA` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `CONDITIONAL` - –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- `LOOP` - –¶–∏–∫–ª—ã
- `DELAY` - –ó–∞–¥–µ—Ä–∂–∫–∏
- `CUSTOM_CODE` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–¥

### –¢–∏–ø—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:

- `SCHEDULE` - –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron)
- `HTTP_WEBHOOK` - HTTP webhook
- `RSS_FEED` - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ RSS
- `FILE_WATCH` - –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- `MESSAGE_QUEUE` - –°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- `MANUAL` - –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
kolybel_core/
‚îú‚îÄ‚îÄ agent_specification.py      # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
‚îú‚îÄ‚îÄ runtime_adapters.py         # –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —Ä–∞–Ω—Ç–∞–π–º–æ–≤
‚îú‚îÄ‚îÄ runtime_orchestrator.py     # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ agents_v2.py               # –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ main_v2.py                 # –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ web_interface.py           # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–æ–±–Ω–æ–≤–ª–µ–Ω)
‚îú‚îÄ‚îÄ deployed_agents/           # –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –∞–≥–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ runtime_deployments.json   # –†–µ–µ—Å—Ç—Ä —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π
‚îî‚îÄ‚îÄ agent_logs/               # –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```bash
python main_v2.py
```

### 3. –ó–∞–ø—É—Å–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```bash
python start_web_interface.py
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–Ω—Ç–∞–π–º–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ n8n

```bash
export N8N_API_URL="http://localhost:5678/api/v1"
export N8N_USER="admin"
export N8N_PASSWORD="password"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker

```bash
# Docker –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
docker --version
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ

```python
config = {
    'execution_policy': 'failover',
    'health_check_interval': 60,
    'n8n': {
        'api_url': 'http://localhost:5678/api/v1',
        'username': 'admin',
        'password': 'password'
    },
    'docker': {
        'enabled': True
    },
    'local': {
        'max_concurrent': 5
    }
}

manager = AgentManager(config=config)
```